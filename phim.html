<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SCTV2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ======================================================= */
        /* C∆† S·ªû V√Ä CU·ªòN NGANG */
        /* ======================================================= */
        body { 
            background-color: #000000; /* Pure Black */
            color: white; 
            min-height: 100vh;
            padding-bottom: 5rem;
        }

        /* ·∫®n thanh cu·ªôn ngang m·∫∑c ƒë·ªãnh nh∆∞ng gi·ªØ ch·ª©c nƒÉng cu·ªôn */
        .scroll-horizontal {
            overflow-x: scroll;
            white-space: nowrap;
            padding-bottom: 10px; 
            -webkit-overflow-scrolling: touch;
        }
        .scroll-horizontal::-webkit-scrollbar {
            display: none;
        }
        .scroll-item {
            display: inline-block;
            vertical-align: top;
            margin-right: 12px;
            text-decoration: none; 
            color: inherit;
        }
        
        /* ======================================================= */
        /* KI·ªÇU CARD */
        /* ======================================================= */
        .poster-card {
            width: 130px; 
            height: 230px;
            overflow: hidden;
            border-radius: 8px;
            position: relative;
            background-color: #1a1a1a;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            transition: transform 0.2s;
            cursor: pointer;
            display: block;
        }
        .poster-card:hover {
            transform: scale(1.05);
        }

        /* Card Xem Ti·∫øp (Horizontal) */
        .continue-item-wrapper {
            width: 200px; 
        }
        .continue-card {
            width: 100%; 
            height: 120px;
            overflow: hidden;
            border-radius: 8px;
            background-color: #1a1a1a;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);
            position: relative;
            cursor: pointer;
        }
        .continue-card img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        .progress-bar {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: rgba(255, 255, 255, 0.3);
        }
        .progress-bar-fill {
            height: 100%;
            background-color: #E50914; 
        }
        .continue-title {
            font-size: 0.75rem; 
            margin-top: 4px; 
            white-space: normal; 
            display: block;
            line-height: 1.3;
            height: 2.6em; 
            overflow: hidden;
        }

        /* ======================================================= */
        /* CSS ICONS T·ªîNG QU√ÅT V√Ä HEADER */
        /* ======================================================= */

        /* Base cho t·∫•t c·∫£ Icon CSS */
        .icon-base {
            display: block;
            width: 24px;
            height: 24px;
            position: relative;
            color: currentColor; 
            transition: all 0.2s;
            flex-shrink: 0; 
            margin-left: auto; 
            margin-right: auto;
        }
        
        /* Style cho danh s√°ch th√¥ng b√°o to√†n m√†n h√¨nh m·ªõi */
        .full-notification-item {
            padding: 16px;
            border-bottom: 1px solid #333;
            cursor: pointer;
            transition: background-color 0.2s;
            background-color: #111;
        }
        .full-notification-item:hover {
            background-color: #222;
        }
        
        /* CSS M·ªöI cho Banner Slides */
        .slide {
            transition: opacity 0.5s ease-in-out;
            opacity: 0;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .slide.active {
            opacity: 1;
            position: relative;
        }
        .slide-image {
            width: 100%; 
            height: 100%; 
            object-fit: cover;
        }
        .indicator {
            transition: opacity 0.3s;
        }
        .indicator.active {
            opacity: 1 !important;
        }

    </style>
</head>
<body class="p-0">

    <header class="sticky top-0 z-20 px-4 pt-4 pb-2 bg-black">
        <div class="flex justify-between items-center" id="header-main">
            <h1 class="text-2xl font-extrabold text-red-600">SCTV<span class="text-white">2026</span></h1>
            
            <div class="flex items-center space-x-3 relative">
                 <button id="plan-button" class="bg-red-600 text-white text-sm font-semibold px-3 py-1 rounded-full shadow-md">Mua</button>
                 
                 <button id="notification-button" class="text-white p-1 rounded-full hover:bg-gray-800 transition">
                    <svg class="icon-base" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path></svg>
                 </button>
                 
                 <button id="search-button" class="text-white p-1 rounded-full hover:bg-gray-800 transition">
                    <svg class="icon-base" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>
                 </button>
            </div>
        </div>
        
        <div id="search-bar" class="mt-2 hidden">
            <input type="text" id="search-input" placeholder="T√¨m ki·∫øm phim, series..." class="w-full p-2 rounded-lg bg-gray-800 text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-red-600">
        </div>
    </header>
    
    <main class="mb-16">
        <div id="featured-banner" class="w-full relative h-[250px] overflow-hidden">
            </div>
        <div class="absolute w-full top-[230px] z-10">
            <div id="banner-indicators" class="flex justify-center space-x-1">
                </div>
        </div>
        
        <div id="content-section" class="mt-6 px-4 hidden">
            
            <div id="search-view" class="">
                <div id="genre-filters" class="mb-4 scroll-horizontal py-2">
                    <button data-genre="all" class="genre-button bg-red-600 text-white text-sm font-semibold px-3 py-1 rounded-full mr-2 transition duration-200 hover:bg-red-600/70">T·∫•t c·∫£</button>
                    <button data-genre="horror" class="genre-button bg-gray-700 text-white text-sm font-semibold px-3 py-1 rounded-full mr-2 hover:bg-red-600 transition duration-200">Kinh d·ªã</button>
                    <button data-genre="war" class="genre-button bg-gray-700 text-white text-sm font-semibold px-3 py-1 rounded-full mr-2 hover:bg-red-600 transition duration-200">Chi·∫øn tranh</button>
                    <button data-genre="animation" class="genre-button bg-gray-700 text-white text-sm font-semibold px-3 py-1 rounded-full mr-2 hover:bg-red-600 transition duration-200">Ho·∫°t h√¨nh</button>
 <button data-genre="anime" class="genre-button bg-gray-700 text-white text-sm font-semibold px-3 py-1 rounded-full mr-2 hover:bg-red-600 transition duration-200">Anime</button>
 <button data-genre="comedy" class="genre-button bg-gray-700 text-white text-sm font-semibold px-3 py-1 rounded-full mr-2 hover:bg-red-600 transition duration-200">H√†i</button>
 <button data-genre="romance" class="genre-button bg-gray-700 text-white text-sm font-semibold px-3 py-1 rounded-full mr-2 hover:bg-red-600 transition duration-200">T√¨nh c·∫£m</button>
                </div>

                <h3 class="text-lg font-bold mb-3">K·∫øt qu·∫£ t√¨m ki·∫øm</h3>
                <div id="search-results-container" class="flex flex-wrap gap-x-3 gap-y-4">
                    </div>
                <p id="no-results" class="text-gray-400 mt-4 hidden">Kh√¥ng t√¨m th·∫•y k·∫øt qu·∫£ n√†o.</p>
            </div>
            
            <div id="notification-detail-view" class="hidden">
                <div id="notification-list-container">
                    <h2 class="text-2xl font-bold mb-4">Th√¥ng b√°o</h2>
                    </div>
                
                <div id="single-notification-content" class="hidden bg-gray-900 p-4 rounded-lg mt-4">
                    <button id="back-to-list-button" class="text-red-500 mb-3 flex items-center">
                        <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                        Quay l·∫°i
                    </button>
                    <h3 id="detail-title" class="text-xl font-bold mb-2 text-red-600"></h3>
                    <p id="detail-content" class="text-sm text-gray-300 whitespace-pre-wrap"></p>
                </div>
            </div>
        </div>
        
        <div id="home-sections">
            
            <div class="mt-6 px-4">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="text-lg font-bold">Phim ƒë·ªÅ xu·∫•t</h3>
                    <span class="text-lg text-gray-500 hover:text-red-600 cursor-pointer">‚Ä∫</span>
                </div>
                <div id="recommended-movies" class="scroll-horizontal">
                    </div>
            </div>

            <div class="mt-6 px-4">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="text-lg font-bold">Ho·∫°t h√¨nh</h3>
                    <span class="text-lg text-gray-500 hover:text-red-600 cursor-pointer">‚Ä∫</span>
                </div>
                <div id="animation-sections" class="scroll-horizontal">
                     </div>
            </div>

            <div class="mt-6 px-4">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="text-lg font-bold">Anime</h3>
                    <span class="text-lg text-gray-500 hover:text-red-600 cursor-pointer">‚Ä∫</span>
                </div>
                <div id="anime-sections" class="scroll-horizontal">
                     </div>
            </div>

            <div class="mt-6 px-4">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="text-lg font-bold">Xem ti·∫øp</h3>
                    <span class="text-lg text-gray-500 hover:text-red-600 cursor-pointer">‚Ä∫</span>
                </div>
                <div id="continue-watching" class="scroll-horizontal">
                     </div>
            </div>

            <div class="mt-6 px-4">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="text-lg font-bold">Xem nhi·ªÅu nh·∫•t tr√™n SCTV2025</h3>
                    <span class="text-lg text-gray-500 hover:text-red-600 cursor-pointer">‚Ä∫</span>
                </div>
                <div id="most-viewed-movies" class="scroll-horizontal">
                     </div>
            </div>
        </div>
    </main>

    <div id="movie-detail-modal" class="fixed inset-0 z-50 bg-black/90 hidden items-center justify-center p-4" onclick="closeModal(event)">
        <div id="modal-content-area" class="bg-gray-900 rounded-xl overflow-hidden shadow-2xl w-full max-w-sm" onclick="event.stopPropagation()">
            <div id="modal-poster-area" class="w-full h-64 relative">
                <img id="modal-poster" src="" alt="" class="w-full h-full object-cover">
                <div class="absolute inset-0 bg-gradient-to-t from-gray-900 to-transparent"></div>
            </div>
            
            <div class="p-4">
                <h3 id="modal-title" class="text-2xl font-bold text-red-500 mb-2"></h3>
                <p id="modal-year" class="text-sm font-bold text-gray-300 mb-1"></p> <p id="modal-genre" class="text-sm font-semibold text-gray-400 mb-3"></p>
                <p id="modal-description" class="text-gray-300 text-sm mb-4"></p>
                <p id="modal-views" class="text-xs text-gray-500 mb-4"></p>
                
                <a id="modal-watch-button" href="#" class="block text-center bg-red-600 text-white font-bold py-3 rounded-lg hover:bg-red-700 transition duration-200 mb-3">
                    ‚ñ∂ Xem Phim Ngay
                </a>
                
                <button id="modal-share-button" class="w-full text-center text-red-500 font-bold py-2 rounded-lg border border-red-500 hover:bg-red-500/10 transition duration-200 flex items-center justify-center">
    <img src="https://i.supaimg.com/3128f588-70f6-420a-8064-e2bec02d23ad.png" alt="Icon Chia s·∫ª" class="w-5 h-5 mr-2">
    Chia s·∫ª
</button>

                
                <button onclick="closeModal()" class="w-full text-center text-gray-400 text-sm mt-3 py-2 hover:text-white transition">
                    ƒê√≥ng
                </button>
            </div>
        </div>
    </div>
    
    <div id="plan-detail-modal" class="fixed inset-0 z-50 bg-black/90 hidden items-center justify-center p-4" onclick="closePlanDetailModal(event)">
        <div class="bg-gray-900 rounded-xl overflow-hidden shadow-2xl w-full max-w-sm" onclick="event.stopPropagation()">
            <div class="p-6">
                <h3 id="plan-modal-title" class="text-3xl font-extrabold text-red-600 mb-2">G√≥i Kh√¥ng gi·ªõi h·∫°n</h3>
                <p id="plan-modal-subtitle" class="text-lg font-semibold text-gray-300 mb-4">Zalopay v√† MB Bank</p>
                
                <div id="plan-features-container" class="space-y-3 mb-6">
                    <div class="flex items-start">
                        <span class="text-green-500 mr-3">‚úî</span>
                        <p class="text-white">Nh·∫≠n th√¥ng b√°o khi c√≥ phim m·ªõi</p>
                    </div>
                    <div class="flex items-start">
                        <span class="text-green-500 mr-3">‚úî</span>
                        <p class="text-white">S·ª± ki·ªán v√† nhi·ªám v·ª•</p>
                    </div>
                    <div class="flex items-start">
                        <span class="text-green-500 mr-3">‚úî</span>
                        <p class="text-white">T·∫∑ng k√®m th·∫ª SCenter Care+</p>
                    </div>
                    
                    <div class="flex items-start">
                        <span class="text-green-500 mr-3">‚úî</span>
                        <p class="text-white">Giao di·ªán v√† t√≠nh nƒÉng l·ªçc phim m·ªõi</p>
                    </div>
                    <div class="flex items-start">
                        <span class="text-green-500 mr-3">‚úî</span>
                        <p class="text-white">√Çm thanh s·ªëng ƒë·ªông (Dolby Atmos / DTS)</p>
                    </div>
                    <div class="flex items-start">
                        <span class="text-green-500 mr-3">‚úî</span>
                        <p class="text-white">Xem b√†i vi·∫øt v√† b√¨nh lu·∫≠n</p>
                    </div>
                </div>
                <button id="initial-buy-button" class="w-full text-center bg-red-600 text-white font-bold py-3 rounded-lg hover:bg-red-700 transition duration-200 mb-3">
                    Mua (Ch·ªâ t·ª´ 29.000 VNƒê/1 th√°ng)
                </button>
                
                <div id="payment-options-container" class="hidden">
                    <p class="text-center text-gray-300 mb-3 font-semibold">Vui l√≤ng ch·ªçn:</p>
                    
                    <button onclick="showQRCodeModal('ZaloPay')" class="w-full text-center bg-blue-500 text-white font-bold py-3 rounded-lg hover:bg-blue-600 transition duration-200 mb-3 flex items-center justify-center">
                        <img src="https://i.supaimg.com/52981b48-dc5e-4592-bc0d-680b0d6da73e.jpg" alt="ZaloPay Icon" class="w-6 h-6 mr-2 bg-white rounded">
                        Thanh to√°n qua ZaloPay
                    </button>
                    
                    <button onclick="showQRCodeModal('MB Bank')" class="w-full text-center bg-white text-gray-900 font-bold py-3 rounded-lg hover:bg-gray-200 transition duration-200 mb-3 flex items-center justify-center">
                         <img src="https://i.supaimg.com/9d64526b-69dc-4d7d-a5c6-003f9f30fd34.jpg" alt="MB Bank Icon" class="w-6 h-6 mr-2">
                        Thanh to√°n qua MB Bank
                    </button>
                </div>
                
                <button onclick="closePlanDetailModal()" class="w-full text-center text-gray-400 text-sm py-2 hover:text-white transition">
                    Tr·ªü v·ªÅ
                </button>
            </div>
        </div>
    </div>

    <div id="qr-payment-modal" class="fixed inset-0 z-50 bg-black/90 hidden items-center justify-center p-4" onclick="closeQRCodeModal(event)">
        <div class="bg-gray-900 rounded-xl shadow-2xl w-full max-w-4xl max-h-full overflow-y-auto" onclick="event.stopPropagation()">
            <div class="p-6">
                <h3 id="qr-modal-title" class="text-2xl font-bold text-center mb-4 text-red-600">Thanh to√°n ZaloPay</h3>
                
                <p class="text-center text-xl font-extrabold text-white mb-4">S·ªë ti·ªÅn c·∫ßn chuy·ªÉn: <span class="text-red-500">29.000 VNƒê</span></p>

                <div class="flex justify-center mb-4 p-2 bg-black rounded-lg">
                    <img id="qr-image" src="" alt="M√£ QR Thanh to√°n" class="w-full h-auto object-contain border border-gray-700 rounded-lg max-h-[80vh]">
                </div>
                
                <div class="bg-gray-800 p-3 rounded-lg border-l-4 border-red-600 mt-4">
                    <p class="text-sm font-semibold text-white mb-2">Sau khi mua g√≥i (ƒë√£ chuy·ªÉn ti·ªÅn), b·∫°n c·∫ßn l√†m theo c√°c b∆∞·ªõc sau:</p>
                    <p class="text-xs text-gray-400">1. 'Ch·ª•p m√†n h√¨nh' giao d·ªãch chuy·ªÉn ti·ªÅn ho√†n th√†nh.</p>
                    <p class="text-xs text-gray-400">2. Truy c·∫≠p m·ª•c 'H·ªó tr·ª£'.</p>
                    <p class="text-xs text-gray-400">3. G·ª≠i ·∫£nh ƒë√£ ch·ª•p m√†n h√¨nh (chuy·ªÉn ti·ªÅn ho√†n th√†nh) ƒë·ªÉ k√≠ch ho·∫°t g√≥i.</p>
                </div>

                <button onclick="returnToPaymentOptions()" class="w-full text-center text-red-500 font-bold py-2 rounded-lg border border-red-500/10 hover:bg-red-500/10 transition duration-200 mt-4">
                    Quay l·∫°i
                </button>
            </div>
        </div>
    </div>
    
    <script>
        // D·ªØ li·ªáu gi·∫£ ƒë·ªãnh ƒê√É C·∫¨P NH·∫¨T (Th√™m tr∆∞·ªùng 'releaseYear')
        const MOVIE_DATA = [
            { 
                id: 1, 
                title: "M∆∞a ƒê·ªè", 
                description: "ƒê·ªôc quy·ªÅn tr√™n SCTV2025.", 
                thumbnail: "https://i.supaimg.com/6e141cb1-3e3a-494a-997d-d5bbf87205ee.jpg", 
                views: 997262,
                genre: "war", 
                releaseYear: 2025, // D·ªØ li·ªáu m·ªõi
                destinationUrl: "https://drive.google.com/file/d/1X_RKrRz-IkiQsTCCUFbOW65eDNqFQfFc/view?usp=drivesdk" 
            },
            { id: 2, title: "T√¥i ƒê√£ Ti√™u Di·ªát Slime Su·ªët 300 NƒÉm V√† ƒê·∫°t C·∫•p ƒê·ªô T·ªëi ƒêa", description: "Nh·∫≠t B·∫£n", thumbnail: "https://i.supaimg.com/247ac28e-3c20-4eff-a05a-01b9f91d7cb5/7f2e84ae-77e7-411d-9115-9ce8831c2e4d.jpg", views: 37845, genre: "anime", releaseYear: 2025, destinationUrl: "https://tv360.vn/movie/toi-da-tieu-diet-slime-suot-300-nam-va-dat-cap-do-toi-da-phan-1-i-ve-been-killing-slimes-for-300-years-and-maxed-out-my-level-season-1?m=26710" },
            { id: 3, title: "C√≤n ra th·ªÉ th·ªëng g√¨ n·ªØa?", description: "Trung Qu·ªëc", thumbnail: "https://cdn2.tuoitre.vn/thumb_w/480/471584752817336320/2026/2/9/edit-con-ra-the-thong-gi-nua-1770625260438910819518.jpeg", views: 1109, genre: "romance", releaseYear: 2025, destinationUrl: "https://tv360.vn/movie/con-ra-the-thong-gi-nua-how-dare-you-lop?m=29776" },
            { id: 4, title: "√ê·ªãa ƒë·∫°o", description: "Vi·ªát Nam", thumbnail: "https://i.supaimg.com/1dac08cb-d1c0-40e1-a0a1-31a50e53db7d.jpg", views: 2736, genre: "war", releaseYear: 2025, destinationUrl: "https://drive.google.com/file/d/1zlcglEn2ZwKD6mU-t8xoLTpsInypk9-N/view?usp=drivesdk" },
            { id: 4, title: "T·∫øt ·ªü l√†ng ƒë·ªãa ng·ª•c", description: "Vi·ªát Nam", thumbnail: "https://i.supaimg.com/2680ae49-9ea8-43d5-994c-adc5f866bde6.webp", views: 7367, genre: "horror", releaseYear: 2023,
                destinationUrl: "https://drive.google.com/drive/folders/1Mu86nJtj7hFdkWmbi-7cSWcbXWxpEpFK"},
            { id: 6, title: "Tr·∫°ng Qu·ª≥nh th·ªùi Nh√≠ Nh·ªë", description: "Vi·ªát Nam", thumbnail: "https://i.supaimg.com/70b565e9-3163-41c2-b5b6-d2099f92ca14.jpg", views: 6846, genre: "animation", releaseYear: 2025,
                destinationUrl: "https://m.tv360.vn/movie/trang-quynh-thoi-nhi-nho?m=25633&page=search&sect=suggest&keyword=Tr%E1%BA%A1ng%20qu%E1%BB%B3nh" },
            // ƒê√£ s·ª≠a l·ªói ch√≠nh t·∫£ 'gener' th√†nh 'genre' cho c√°c phim d∆∞·ªõi ƒë√¢y
            { id: 7, title: "ƒê√®n √Çm H·ªìn", description: "Vi·ªát Nam", thumbnail: "https://i.supaimg.com/5e51a64a-1bed-45ad-b274-668fedc90b98.jpg", views: 5358, genre: "horror", releaseYear: 2025, destinationUrl: "https://drive.google.com/file/d/1dirnYjv9C5miNrUrjt74vDna_t9HpNj8/view?usp=drivesdk" },
            { id: 8, title: "√Çm D∆∞∆°ng L·ªô", description: "Vi·ªát Nam", thumbnail: "https://i.supaimg.com/7211b2ec-9320-476f-b908-7e824f5810d3.jpg", views: 2883, genre: "horror", releaseYear: 2025, destinationUrl: "https://drive.google.com/file/d/1XHxLT1wRnj4kOgHPcZO4_UKZGc1_ZGcv/view?usp=drivesdk" },
            // ƒê√£ s·ª≠a ID c·ªßa Linh Mi√™u t·ª´ 6 sang 7 (v√¨ ID 6 l√† √Çm D∆∞∆°ng L·ªô), v√† s·ª≠a l·ªói 'gener'
            { id: 9, title: "Linh Mi√™u: Qu·ª∑ Nh·∫≠p Tr√†ng", description: "Vi·ªát Nam", thumbnail: "https://i.supaimg.com/eb081615-f4ab-4977-85c3-d77a6700e7e0.jpg", views: 3847, genre: "horror", releaseYear: 2025, destinationUrl: "https://drive.google.com/file/d/1rwUL_XpM6VYKSy9e3saod1mGUSukKl-l/view?usp=drivesdk" },
            { id: 10, title: "C√°m", description: "Vi·ªát Nam", thumbnail: "https://i.supaimg.com/77d6a21f-33d2-4437-af62-7711fbfe1be6.jpg", views: 6612, genre: "horror", releaseYear: 2025, destinationUrl: "https://drive.google.com/file/d/1TrdkWvPktqBU-KOmv5kZnj9D9UoFnGmo/view?usp=drivesdk"},
            { id: 11, title: "Series ƒÇn C∆°m C√πng Doraemon #156‚Äã | Gi√°ng Sinh ·∫•m √°p v√† an l√†nh! Merry Christmas üéÑ ƒë√°y h·ªì", description: "Nh·∫≠t B·∫£n", thumbnail: "https://i.ytimg.com/vi/CYoyKVvQC7U/maxresdefault.jpg", views: 52627, genre: "animation", releaseYear: 2025, destinationUrl: " https://youtu.be/CYoyKVvQC7U?si=RMiiGhBGAlR8iCC-" },
            { id: 12, title: " G·∫•u M·∫≠p H·ªçc V√µ - Kung Fu Panda", description: "M·ªπ", thumbnail: "https://upload.wikimedia.org/wikipedia/vi/1/18/Kung_fu_panda_poster.jpg", views: 597, genre: "animation", releaseYear: 2008, destinationUrl: "https://drive.google.com/file/d/1sqD-igbuiteNlerPQr6ZdUP51iQIDciT/view?usp=drivesdk" },
            { id: 13, title: "Natra Ma ƒê·ªìng Gi√°ng Th·∫ø", description: "Trung Qu·ªëc", thumbnail: "https://iguov8nhvyobj.vcdn.cloud/media/catalog/product/cache/1/image/1800x/71252117777b696995f01934522c402d/p/o/poster_natra-final_1_.jpg", views: 113, genre: "animation", releaseYear: "2019", destinationUrl: "https://drive.google.com/file/d/11SzceN8EIK_t8Aki_6y33v7tnVthMNiI/view?usp=drivesdk" },
            { id: 14, title: "S·ª± Tr·ªói D·∫≠y C·ªßa C√°c V·ªá Th·∫ßn", description: "M·ªπ", thumbnail: "https://image.tmdb.org/t/p/original/abG7QNX6Ba03WQXlXwOj08QKn4Z.jpg", views: 8365, genre: "animation", releaseYear: 2012, destinationUrl: "https://drive.google.com/file/d/1n3egviIlOGR8lnh957av8ZcEIGmgom0t/view?usp=drivesdk" },
            // Phim 'Xem ti·∫øp' (v·∫´n gi·ªØ nguy√™n logic c≈©)
            { id: 15, title: "M∆∞a ƒê·ªè", description: "Vi·ªát Nam", thumbnail: "https://i.supaimg.com/6e141cb1-3e3a-494a-997d-d5bbf87205ee.jpg", views: 2846, progress: '0%', genre: "war", releaseYear: 2025, destinationUrl: "https://drive.google.com/file/d/1X_RKrRz-IkiQsTCCUFbOW65eDNqFQfFc/view?usp=drivesdk" },
            { id: 16, title: "T·∫øt ·ªü l√†ng ƒë·ªãa ng·ª•c", description: "Vi·ªát Nam", thumbnail: "https://i.supaimg.com/2680ae49-9ea8-43d5-994c-adc5f866bde6.webp", views: 7564, progress: '0%', genre: "horror", releaseYear: 2023, destinationUrl: "https://drive.google.com/drive/folders/1Mu86nJtj7hFdkWmbi-7cSWcbXWxpEpFK" },
            { id: 17, title: "Tr·∫°ng Qu·ª≥nh th·ªùi Nh√≠ Nh·ªë", description: "Vi·ªát Nam", thumbnail: "https://i.supaimg.com/70b565e9-3163-41c2-b5b6-d2099f92ca14.jpg", views: 38465, progress: '0%', genre: "animation", releaseYear: 2025, destinationUrl: "https://m.tv360.vn/movie/trang-quynh-thoi-nhi-nho?m=25633&page=search&sect=suggest&keyword=Tr%E1%BA%A1ng%20qu%E1%BB%B3nh" },
            { id: 18, title: "Doraemom - M√πa 13", description: "Nh·∫≠t B·∫£n", thumbnail: "https://i.supaimg.com/247ac28e-3c20-4eff-a05a-01b9f91d7cb5/6698d018-ca71-477f-be4a-aac3d02d4a75.png", views: 4352, genre: "animation", releaseYear: 2025, destinationUrl: "https://tv360.vn/movie/doraemon-mua-13-vtw?m=29726" },
            { id: 19, title: "N√†ng d√¢u ng√†y t·∫øt", description: "Vi·ªát Nam", thumbnail: "https://i.supaimg.com/247ac28e-3c20-4eff-a05a-01b9f91d7cb5/b3ba8b59-3ca2-4e37-8f58-9945ab5c0b8a.jpg", views: 9832, genre: "comedy", releaseYear: 2026, destinationUrl: "https://tv360.vn/movie/nang-dau-ngay-tet-jli?m=29827" },
            { id: 20, title: "Y·∫øt H√≠", description: "Trung Qu·ªëc", thumbnail: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTgOJrssQjvGTUydJ2XhcRuupwh6mEsyNiG8aYMoAotTQ&s=10", views: 5358, genre: "romance", releaseYear: 2026, destinationUrl: "https://tv360.vn/movie/yet-hi-love-between-lines-sdy?m=29663" },
            { id: 21, title: "Ti√™u Dao", description: "Trung Qu·ªëc", thumbnail: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTvmf57YUkdGOa42ODC_if6MRwCljwQNw94vkZ8Yu9ik0duKxX8882yPx_I&s=10", views: 4251, genre: "romance", releaseYear: 2025, destinationUrl: "https://tv360.vn/movie/tieu-dao-the-unclouded-soul-lvf?m=29639" },
            { id: 22, title: "C∆∞·ªùi d∆∞·ªõi m√°i ƒë√¨nh", description: "Vi·ªát Nam", thumbnail: "https://i.supaimg.com/247ac28e-3c20-4eff-a05a-01b9f91d7cb5/9f9c8a14-304c-48c8-b28a-9087dfc4014c.jpgl", views: 19805, genre: "comedy", releaseYear: 2026, destinationUrl: "https://tv360.vn/movie/cuoi-duoi-mai-dinh-uvi?m=29794" },
           
        ];
        
        // D·ªÆ LI·ªÜU M·ªöI: C√°c banner cho ph·∫ßn n·ªïi b·∫≠t
        const BANNER_SLIDES = [
             {
                imageUrl: "https://i.supaimg.com/605d62fb-8dac-41eb-a264-5053d8b184c1.jpg",
                title: "M∆∞a ƒê·ªè",
                subtitle: "ƒê·ªôc Quy·ªÅn tr√™n SCTV2025",
                extraTag: "4K ULTRALIVE",
                destinationUrl: "https://drive.google.com/file/d/1X_RKrRz-IkiQsTCCUFbOW65eDNqFQfFc/view?usp=drivesdk"
            },
            {
                imageUrl: "https://i.supaimg.com/681de12a-dfa0-4396-b462-9a5b2fe9f1c8.jpg",
                title: "Tr·∫°ng Qu·ª≥nh th·ªùi Nh√≠ Nh·ªë",
                subtitle: "Ho·∫°t h√¨nh Vi·ªát Nam 2025",
                extraTag: "M·ªöI",
                destinationUrl: "https://m.tv360.vn/movie/trang-quynh-thoi-nhi-nho?m=25633&page=search&sect=suggest&keyword=Tr%E1%BA%A1ng%20qu%E1%BB%B3nh"
            },
            {
                imageUrl: "https://cdn2.tuoitre.vn/thumb_w/480/471584752817336320/2026/2/9/edit-con-ra-the-thong-gi-nua-1770625260438910819518.jpeg",
                title: "C√≤n ra th·ªÉ th·ªëng g√¨ n·ªØa?",
                subtitle: "Phim T√¨nh c·∫£m",
                extraTag: "HOT",
                destinationUrl: "https://tv360.vn/movie/con-ra-the-thong-gi-nua-how-dare-you-lop?m=29776"
            },
            {
                imageUrl: "https://i.supaimg.com/247ac28e-3c20-4eff-a05a-01b9f91d7cb5/a21ff883-5de2-4d03-953b-402ab8ce4760.jpg",
                title: "T√¥i ƒê√£ Ti√™u Di·ªát Slime Su·ªët 300 NƒÉm V√† ƒê·∫°t C·∫•p ƒê·ªô T·ªëi ƒêa",
                subtitle: "Anime",
                extraTag: "HOT",
                destinationUrl: "https://tv360.vn/movie/toi-da-tieu-diet-slime-suot-300-nam-va-dat-cap-do-toi-da-phan-1-i-ve-been-killing-slimes-for-300-years-an"
            },
            {
                imageUrl: "https://i.supaimg.com/72b056e9-d64a-4270-884e-f4abe873638d.jpg",
                title: "T·∫øt ·ªü l√†ng ƒë·ªãa ng·ª•c",
                subtitle: "Series kinh d·ªã ƒë∆∞·ª£c y√™u th√≠ch",
                extraTag: "HOT",
                destinationUrl: "https://drive.google.com/drive/folders/1Mu86nJtj7hFdkWmbi-7cSWcbXWxpEpFK"
            }
        ];
        let currentSlideIndex = 0;
        let slideInterval;
   
        // D·ªØ li·ªáu Th√¥ng b√°o gi·∫£ ƒë·ªãnh
        const NOTIFICATION_DATA = [
            { id: 105, title: "S·ª± ki·ªán T·∫øt 2026", content: "S·ª± ki·ªán T·∫øt 2026 s·∫Ω di·ªÖn ra v√†o ng√†y 31/12/2025. \n\nKhi mua g√≥i Kh√¥ng gi·ªõi h·∫°n s·∫Ω c√≥ c√°c nhi·ªám v·ª• v√† c√°c ph·∫ßn th∆∞·ªüng trong S·ª± ki·ªán.\nƒê·ªÉ tham gia S·ª± ki·ªán, b·∫°n h√£y mua g√≥i Kh√¥ng gi·ªõi h·∫°n ƒë·ªÉ tham gia.", date: "T.4, 9 Th12, 2025, 17:29" },
            { id: 106, title: "Ra m·∫Øt g√≥i m·ªõi", content: "Ra m·∫Øt g√≥i \"Kh√¥ng gi·ªõi h·∫°n\" khi mua s·∫Ω ƒë∆∞·ª£c t·∫≠n h∆∞·ªüng c√°c t√≠nh nƒÉng m·ªõi.\n\n-Nh·∫≠n th√¥ng b√°o khi c√≥ phim m·ªõi \n-Xem b√†i vi·∫øt v√† b√¨nh lu·∫≠n. \n-T·∫∑ng k√®m th·∫ª SCenter Care+ \n-Giao di·ªán v√† t√≠nh nƒÉng l·ªçc phim m·ªõi \n-√Çm thanh s·ªëng ƒë·ªông \n-S·ª± ki·ªán v√† nhi·ªám v·ª•", date: "T.2, 8 Th12 2025, 17:08" },
            { id: 107, title: "Th√¥ng b√°o quan tr·ªçng", content: "Trong phim xu·∫•t hi·ªán qu·∫£ng c√°o. ƒê√¢y kh√¥ng ph·∫£i qu·∫£ng c√°o c·ªßa SCTV2025, phim ƒë∆∞·ª£c t·∫£i v·ªÅ t·ª´ n·ªÅn t·∫£ng kh√°c. Qu·∫£ng c√°o n√†y xu·∫•t hi·ªán ch·ªØ tr√™n phim.\n\nR·∫•t mong m·ªçi ng∆∞·ªùi th√¥ng c·∫£m.\n\nCh√∫c m·ªçi ng∆∞·ªùi xem phim vui v·∫ª.\n\nXin c·∫£m ∆°n!", date: "CN, 30 Th11 2025, 17:47" },
            { id: 108, title: "Phim m·ªõi: M∆∞a ƒê·ªè ƒë√£ ra m·∫Øt!", content: "B·ªô phim ƒë·ªôc quy·ªÅn v·ªÅ ƒë·ªÅ t√†i chi·∫øn tranh Vi·ªát Nam 'M∆∞a ƒê·ªè' ƒë√£ ch√≠nh th·ª©c c√≥ m·∫∑t tr√™n SCTV2025 v·ªõi ch·∫•t l∆∞·ª£ng 4K ULTRALIVE.\n\nƒê·ª´ng b·ªè l·ª° nh·ªØng th∆∞·ªõc phim tuy·ªát v·ªùi v·ªõi k·ªπ x·∫£o ho√†nh tr√°ng! Nh·∫•p v√†o ƒë√¢y ƒë·ªÉ xem ngay!", date: "T7, 29 Th11 2025, 18:30" },
            { id: 109, title: "Khuy·∫øn m√£i 4K ULTRALIVE", content: "B·∫°n ƒë∆∞·ª£c t·∫∑ng 3 ng√†y xem mi·ªÖn ph√≠ g√≥i 4K ULTRALIVE. Khuy·∫øn m√£i s·∫Ω t·ª± ƒë·ªông h·∫øt h·∫°n sau 72 gi·ªù.\n\nH√£y t·∫≠n h∆∞·ªüng n·ªôi dung s·∫Øc n√©t nh·∫•t!", date: "T7, 30 Th11 2025, 18: 25" },
            { id: 110, title: "C·∫≠p nh·∫≠t t√†i kho·∫£n", content: "T√†i kho·∫£n c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c gia h·∫°n th√†nh c√¥ng g√≥i C∆° b·∫£n.\n\nC·∫£m ∆°n b·∫°n ƒë√£ s·ª≠ d·ª•ng d·ªãch v·ª• v√† ti·∫øp t·ª•c ·ªßng h·ªô ch√∫ng t√¥i!", date: "T7, 30 Th11 2025, 18: 20" },
        ];
        
        // --- H√ÄM H·ªñ TR·ª¢ HI·ªÇN TH·ªä ---
        
        // Chuy·ªÉn ch·∫ø ƒë·ªô xem: Home, Search, ho·∫∑c Notification
        function setViewMode(mode) {
            const homeSections = document.getElementById('home-sections');
            const contentSection = document.getElementById('content-section');
            const searchView = document.getElementById('search-view');
            const notificationView = document.getElementById('notification-detail-view');
            const featuredBanner = document.getElementById('featured-banner'); 
            const bannerIndicators = document.getElementById('banner-indicators').parentNode; // L·∫•y div cha ch·ª©a indicator
            
            // D·ª´ng slide khi kh√¥ng ·ªü Home
            if (mode !== 'home') {
                 clearInterval(slideInterval);
                 bannerIndicators.classList.add('hidden');
            }

            // ƒê√≥ng modal chi ti·∫øt g√≥i n·∫øu n√≥ ƒëang m·ªü
            closePlanDetailModal(); 
            // ƒê√≥ng modal thanh to√°n QR/Bank n·∫øu n√≥ ƒëang m·ªü
            closeQRCodeModal();

            // ·∫®n t·∫•t c·∫£ tr∆∞·ªõc
            homeSections.classList.add('hidden');
            contentSection.classList.add('hidden');
            searchView.classList.add('hidden');
            notificationView.classList.add('hidden');
            featuredBanner.classList.add('hidden'); 

            if (mode === 'home') {
                homeSections.classList.remove('hidden');
                featuredBanner.classList.remove('hidden'); 
                bannerIndicators.classList.remove('hidden');
                startAutoSlide(); // Kh·ªüi ƒë·ªông slide khi ·ªü Home
            } else if (mode === 'search') {
                contentSection.classList.remove('hidden');
                searchView.classList.remove('hidden');
            } else if (mode === 'notification') {
                contentSection.classList.remove('hidden');
                notificationView.classList.remove('hidden');
            }
        }

        // --- H√ÄM M·ªöI CHO BANNER SLIDESHOW ---
        
        function renderBanners() {
            const bannerContainer = document.getElementById('featured-banner');
            const indicatorsContainer = document.getElementById('banner-indicators');
            bannerContainer.innerHTML = '';
            indicatorsContainer.innerHTML = '';

            BANNER_SLIDES.forEach((slide, index) => {
                // 1. T·∫°o Slide
                const slideElement = document.createElement('div');
                slideElement.className = `slide ${index === 0 ? 'active' : ''}`;
                slideElement.innerHTML = `
                    <a href="${slide.destinationUrl}" class="w-full h-full block">
                        <img src="${slide.imageUrl}" alt="${slide.title}" class="slide-image">
                        
                        <div class="absolute inset-0 bg-gradient-to-t from-black via-black/40 to-transparent p-4 flex flex-col justify-end">
                            <div class="flex justify-end items-center mb-1">
                                ${slide.extraTag ? `<span class="text-[10px] font-semibold text-white bg-red-600/80 px-1 py-0.5 rounded-sm mr-2">${slide.extraTag}</span>` : ''}
                            </div>
                            <h2 class="text-2xl font-extrabold text-white">${slide.title}</h2>
                            <p class="text-sm font-bold text-white mt-1">${slide.subtitle}</p>
                        </div>
                    </a>
                `;
                bannerContainer.appendChild(slideElement);

                // 2. T·∫°o Indicator
                const indicator = document.createElement('div');
                indicator.className = `w-1 h-1 bg-white rounded-full indicator ${index === 0 ? 'opacity-100 active' : 'opacity-50'}`;
                indicator.setAttribute('data-index', index);
                indicator.addEventListener('click', () => {
                    clearInterval(slideInterval);
                    showSlide(index);
                    startAutoSlide();
                });
                indicatorsContainer.appendChild(indicator);
            });
        }
        
        function showSlide(index) {
            const slides = document.querySelectorAll('#featured-banner .slide');
            const indicators = document.querySelectorAll('#banner-indicators .indicator');

            if (index >= slides.length) {
                currentSlideIndex = 0;
            } else if (index < 0) {
                currentSlideIndex = slides.length - 1;
            } else {
                currentSlideIndex = index;
            }

            slides.forEach((slide, i) => {
                if (i === currentSlideIndex) {
                    slide.classList.add('active');
                } else {
                    slide.classList.remove('active');
                }
            });

            indicators.forEach((indicator, i) => {
                if (i === currentSlideIndex) {
                    indicator.classList.add('active');
                    indicator.classList.remove('opacity-50');
                } else {
                    indicator.classList.remove('active');
                    indicator.classList.add('opacity-50');
                }
            });
        }
        
        function nextSlide() {
            showSlide(currentSlideIndex + 1);
        }
        
        function startAutoSlide() {
            clearInterval(slideInterval); // ƒê·∫£m b·∫£o kh√¥ng c√≥ interval n√†o ch·∫°y song song
            slideInterval = setInterval(nextSlide, 5000); // T·ª± ƒë·ªông chuy·ªÉn slide sau 5 gi√¢y
        }


        // --- H√ÄM T·∫†O CARD POSTER/CONTINUE V√Ä MODAL ---
        
        function getRegularMovies() {
             return MOVIE_DATA.filter(movie => !movie.progress);
        }
        function getContinueMovies() {
             return MOVIE_DATA.filter(movie => movie.progress);
        }

        // H√†m chuy·ªÉn ƒë·ªïi th·ªÉ lo·∫°i (genre) t·ª´ key ti·∫øng Anh sang t√™n ti·∫øng Vi·ªát
        function getVietnameseGenre(genreKey) {
            switch (genreKey) {
                case 'horror':
                    return 'Kinh d·ªã';
                case 'war':
                    return 'Chi·∫øn tranh VN';
                case 'animation':
                    return 'Ho·∫°t h√¨nh';
                case 'rom-com':
                    return 'H√†i t√¨nh c·∫£m';
                default:
                    return 'Ch∆∞a ph√¢n lo·∫°i';
            }
        }
        
        // M·ªü modal v√† ƒëi·ªÅn d·ªØ li·ªáu ƒê√É C·∫¨P NH·∫¨T
        function openModal(movie) {
             // D·ª´ng auto slide khi m·ªü modal
             clearInterval(slideInterval);
             
            document.getElementById('modal-poster').src = movie.thumbnail;
            document.getElementById('modal-poster').alt = movie.title;
            document.getElementById('modal-title').textContent = movie.title;
            
            // Th√™m NƒÉm ph√°t h√†nh
            document.getElementById('modal-year').textContent = `NƒÉm ph√°t h√†nh: ${movie.releaseYear || 'Ch∆∞a x√°c ƒë·ªãnh'}`;
            
            // T√¨m v√† hi·ªÉn th·ªã l∆∞·ª£t xem
            const views = typeof movie.views === 'number' ? movie.views.toLocaleString('vi-VN') : (movie.views || 0).toString();
            
            // L·∫•y t√™n th·ªÉ lo·∫°i b·∫±ng ti·∫øng Vi·ªát
            const vietnameseGenre = getVietnameseGenre(movie.genre);
            
            // C·∫≠p nh·∫≠t modal-genre v·ªõi t√™n ti·∫øng Vi·ªát
            document.getElementById('modal-genre').textContent = `Th·ªÉ lo·∫°i: ${vietnameseGenre}`;

            document.getElementById('modal-description').textContent = movie.description;
            document.getElementById('modal-views').textContent = `L∆∞·ª£t xem: ${views}`;
            document.getElementById('modal-watch-button').href = movie.destinationUrl || '#';
            
            // G√°n s·ª± ki·ªán cho n√∫t chia s·∫ª
            const shareButton = document.getElementById('modal-share-button');
            // X√≥a s·ª± ki·ªán c≈© (n·∫øu c√≥) ƒë·ªÉ tr√°nh l·∫∑p l·∫°i
            const newShareButton = shareButton.cloneNode(true);
            shareButton.parentNode.replaceChild(newShareButton, shareButton);

            newShareButton.addEventListener('click', () => shareMovie(movie));
            
            // Hi·ªÉn th·ªã modal
            document.getElementById('movie-detail-modal').classList.remove('hidden');
            document.getElementById('movie-detail-modal').classList.add('flex');
            document.body.style.overflow = 'hidden'; // NgƒÉn cu·ªôn n·ªÅn
        }

        // ƒê√≥ng modal chi ti·∫øt phim
        function closeModal(event) {
            // ƒê√≥ng n·∫øu nh·∫•p v√†o n√∫t ƒë√≥ng ho·∫∑c nh·∫•p ra ngo√†i modal (target l√† ch√≠nh modal)
            if (!event || event.target.id === 'movie-detail-modal' || event.currentTarget.tagName === 'BUTTON') {
                document.getElementById('movie-detail-modal').classList.add('hidden');
                document.getElementById('movie-detail-modal').classList.remove('flex');
                document.body.style.overflow = ''; // Cho ph√©p cu·ªôn l·∫°i
                
                // Kh·ªüi ƒë·ªông l·∫°i auto slide n·∫øu ƒëang ·ªü Home View
                if (document.getElementById('home-sections').classList.contains('hidden') === false) {
                     startAutoSlide();
                }
            }
        }
        
        function createPosterCard(movie, isSearchResult = false) {
             // Thay th·∫ª <a> b·∫±ng <div> ƒë·ªÉ g√°n s·ª± ki·ªán m·ªü modal
             const cardWrapper = document.createElement('div');
             cardWrapper.className = isSearchResult ? 'block' : 'scroll-item';
             cardWrapper.setAttribute('data-movie-id', movie.id);
             
             // G√°n s·ª± ki·ªán m·ªü modal
             cardWrapper.addEventListener('click', () => openModal(movie));
             
             const cardClass = isSearchResult ? 'poster-card !w-full sm:!w-[130px]' : 'poster-card';

             cardWrapper.innerHTML = `
                 <div class="${cardClass}">
                     <img src="${movie.thumbnail}" alt="${movie.title}" class="w-full h-full object-cover">
                     <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent p-2 flex flex-col justify-end">
                         <h4 class="font-bold text-sm truncate">${movie.title.replace(' (Xem ti·∫øp)', '')}</h4>
                     </div>
                     ${movie.id === 1 ? '<span class="absolute top-1 left-1 text-[10px] bg-red-600 text-white px-1 rounded-sm font-bold">4K ULTRALIVE</span>' : ''}
                 </div>
             `;
             if (isSearchResult) {
                 cardWrapper.style.marginBottom = '16px';
             }
             return cardWrapper;
         }

        function createContinueCard(movie) {
            // Card xem ti·∫øp v·∫´n gi·ªØ logic chuy·ªÉn h∆∞·ªõng th·∫≥ng
            const link = document.createElement('a');
            link.href = movie.destinationUrl || `#phim-${movie.id}`;
            link.className = 'scroll-item continue-item-wrapper'; 
            
            link.innerHTML = `
                 <div class="continue-card">
                    <img src="${movie.thumbnail}" alt="${movie.title}" class="w-full h-full object-cover">
                    <div class="progress-bar">
                        <div class="progress-bar-fill" style="width: ${movie.progress || '0%'}"></div>
                    </div>
                    <div class="absolute inset-0 flex items-center justify-center bg-black/30">
                         <span class="text-4xl text-white/90 drop-shadow-md">‚ñ∂</span>
                    </div>
                </div>
                <p class="continue-title text-gray-300">${movie.title.replace(' (Xem ti·∫øp)', '')}</p>
            `;
            return link;
        }
        
        // H√ÄM M·ªöI: X·ª≠ l√Ω chia s·∫ª phim
        function shareMovie(movie) {
             const vietnameseGenre = getVietnameseGenre(movie.genre);
             const shareData = {
                 title: `Xem phim: ${movie.title} tr√™n SCTV2025!`,
                 text: `T√¥i ƒëang xem b·ªô phim "${movie.title}" (${movie.releaseYear || 'M·ªõi'}). Th·ªÉ lo·∫°i: ${vietnameseGenre}. Xem ngay t·∫°i:`,
                 url: movie.destinationUrl || window.location.href,
             };
            
             if (navigator.share) {
                 // D√πng API chia s·∫ª g·ªëc c·ªßa h·ªá ƒëi·ªÅu h√†nh n·∫øu c√≥
                 navigator.share(shareData)
                     .then(() => {
                        alert(`ƒê√£ chia s·∫ª th√†nh c√¥ng phim "${movie.title}"!`);
                     })
                     .catch((error) => {
                        console.error('L·ªói khi chia s·∫ª', error);
                         // N·∫øu ng∆∞·ªùi d√πng h·ªßy chia s·∫ª, kh√¥ng c·∫ßn th√¥ng b√°o l·ªói l·ªõn, d√πng fallback
                         copyFallback(movie.title, shareData);
                     });
             } else {
                 // Fallback: sao ch√©p URL v√†o clipboard
                 copyFallback(movie.title, shareData);
             }
         }

         function copyFallback(title, shareData) {
              const fallbackText = `${shareData.title}\n${shareData.text} ${shareData.url}`;
              
              // T·∫°o m·ªôt textarea ·∫©n ƒë·ªÉ sao ch√©p
              const tempInput = document.createElement('textarea');
              tempInput.value = fallbackText;
              document.body.appendChild(tempInput);
              tempInput.select();
              document.execCommand('copy');
              document.body.removeChild(tempInput);
              
              alert(`T√≠nh nƒÉng Chia s·∫ª kh√¥ng ƒë∆∞·ª£c h·ªó tr·ª£. ƒê√£ sao ch√©p li√™n k·∫øt c·ªßa phim "${title}" v√†o clipboard!`);
         }
        
        
        // --- CH·ª®C NƒÇNG TH√îNG B√ÅO TO√ÄN M√ÄN H√åNH ---
        
        // 1. Hi·ªÉn th·ªã danh s√°ch th√¥ng b√°o (M√†n h√¨nh ch√≠nh c·ªßa Notification)
        function showFullNotificationList() {
            setViewMode('notification'); 
            
            document.getElementById('notification-list-container').classList.remove('hidden');
            document.getElementById('single-notification-content').classList.add('hidden');
            
            const listContainer = document.getElementById('notification-list-container');
            let html = '<h2 class="text-2xl font-bold mb-4">Th√¥ng b√°o</h2>';
            
            if (NOTIFICATION_DATA.length === 0) {
                 html += '<p class="text-gray-400">Kh√¥ng c√≥ th√¥ng b√°o m·ªõi.</p>';
                 listContainer.innerHTML = html;
                 return;
            }

            NOTIFICATION_DATA.forEach(notif => {
                html += `
                    <div 
                        class="full-notification-item" 
                        data-notif-id="${notif.id}" 
                        onclick="showNotificationDetail(${notif.id})"
                    >
                        <p class="text-sm font-bold text-white">${notif.title}</p>
                        <p class="text-xs text-red-500 mt-1">${notif.date}</p>
                        <p class="text-xs text-gray-400 mt-1 line-clamp-2">${notif.content}</p>
                    </div>
                `;
            });
            
            listContainer.innerHTML = html;
        }
        
        // 2. Hi·ªÉn th·ªã chi ti·∫øt th√¥ng b√°o
        function showNotificationDetail(notifId) {
            const notif = NOTIFICATION_DATA.find(n => n.id === notifId);
            
            if (!notif) return;
            
            document.getElementById('notification-list-container').classList.add('hidden');
            document.getElementById('single-notification-content').classList.remove('hidden');
            
            document.getElementById('detail-title').textContent = notif.title;
            document.getElementById('detail-content').textContent = notif.content;
        }
        
        // 3. X·ª≠ l√Ω n√∫t quay l·∫°i
        function setupNotificationListeners() {
            document.getElementById('notification-button').addEventListener('click', () => {
                 // ƒê·∫£m b·∫£o thanh t√¨m ki·∫øm ·∫©n
                 if (!document.getElementById('search-bar').classList.contains('hidden')) {
                     document.getElementById('search-button').click();
                 }
                 // ƒê√≥ng modal chi ti·∫øt phim
                 closeModal();
                 showFullNotificationList();
            });
            
            document.getElementById('back-to-list-button').addEventListener('click', showFullNotificationList);
        }
        
        // --- CH·ª®C NƒÇNG G√ìI MUA M·ªöI (ƒê√É S·ª¨A) ---

        // M·ªü modal chi ti·∫øt g√≥i mua (Ch·∫ø ƒë·ªô xem t√≠nh nƒÉng)
        function showPlanDetailModal() {
             // D·ª´ng auto slide khi m·ªü modal
             clearInterval(slideInterval);
             
            document.getElementById('plan-detail-modal').classList.remove('hidden');
            document.getElementById('plan-detail-modal').classList.add('flex');
            document.body.style.overflow = 'hidden'; // NgƒÉn cu·ªôn n·ªÅn
            
            // ƒê·∫∑t ti√™u ƒë·ªÅ cho ch·∫ø ƒë·ªô xem t√≠nh nƒÉng: G√≥i Kh√¥ng gi·ªõi h·∫°n
            document.getElementById('plan-modal-title').textContent = 'G√≥i Kh√¥ng gi·ªõi h·∫°n';
            document.getElementById('plan-modal-subtitle').textContent = 'Zalopay v√† MB Bank'; 
            
            // ƒê·∫£m b·∫£o ban ƒë·∫ßu ch·ªâ hi·ªÉn th·ªã t√≠nh nƒÉng v√† n√∫t MUA G√ìI
            const featuresContainer = document.getElementById('plan-features-container');
            const initialBuyButton = document.getElementById('initial-buy-button');
            const paymentOptionsContainer = document.getElementById('payment-options-container');

            if (featuresContainer && initialBuyButton && paymentOptionsContainer) {
                 // Khi m·ªü l·∫ßn ƒë·∫ßu, hi·ªÉn th·ªã c√°c t√≠nh nƒÉng
                 featuresContainer.classList.remove('hidden');
                 initialBuyButton.classList.remove('hidden');
                 paymentOptionsContainer.classList.add('hidden');
            }
        }

        // ƒê√≥ng modal chi ti·∫øt g√≥i mua
        function closePlanDetailModal(event) {
            // ƒê√≥ng n·∫øu nh·∫•p v√†o n√∫t ƒë√≥ng ho·∫∑c nh·∫•p ra ngo√†i modal (target l√† ch√≠nh modal)
            if (!event || event.target.id === 'plan-detail-modal' || event.currentTarget.tagName === 'BUTTON') {
                document.getElementById('plan-detail-modal').classList.add('hidden');
                document.getElementById('plan-detail-modal').classList.remove('flex');
                document.body.style.overflow = ''; // Cho ph√©p cu·ªôn l·∫°i
                
                // Kh·ªüi ƒë·ªông l·∫°i auto slide n·∫øu ƒëang ·ªü Home View
                if (document.getElementById('home-sections').classList.contains('hidden') === false) {
                     startAutoSlide();
                }
            }
        }
        
        // Hi·ªÉn th·ªã l·ª±a ch·ªçn thanh to√°n (Ch·∫ø ƒë·ªô ch·ªçn ph∆∞∆°ng th·ª©c)
        function showPaymentOptions() {
             // ·∫®n th√¥ng tin t√≠nh nƒÉng v√† n√∫t mua ban ƒë·∫ßu
             document.getElementById('plan-features-container').classList.add('hidden');
             document.getElementById('initial-buy-button').classList.add('hidden');
             
             // Hi·ªÉn th·ªã l·ª±a ch·ªçn thanh to√°n
             document.getElementById('payment-options-container').classList.remove('hidden');
             
             // ƒê·∫∑t ti√™u ƒë·ªÅ cho ch·∫ø ƒë·ªô xem thanh to√°n: Ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n
             document.getElementById('plan-modal-title').textContent = 'Ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n';
             document.getElementById('plan-modal-subtitle').textContent = 'Zalopay v√† MB Bank';
        }
        
        // Hi·ªÉn th·ªã modal QR/Bank (H√ÄM M·ªöI)
        function showQRCodeModal(method) {
            closePlanDetailModal(); // ƒê√≥ng modal chi ti·∫øt g√≥i tr∆∞·ªõc
            
            const qrModal = document.getElementById('qr-payment-modal');
            const qrImage = document.getElementById('qr-image');
            const qrTitle = document.getElementById('qr-modal-title');
            
            if (method === 'ZaloPay') {
                qrTitle.textContent = 'Thanh to√°n ZaloPay';
                // ·∫¢nh ZaloPay t·ª´ link b·∫°n cung c·∫•p
                qrImage.src = 'https://i.supaimg.com/d73eeec3-be4c-4f5d-9b05-be49430be8d4.jpg';
            } else if (method === 'MB Bank') {
                qrTitle.textContent = 'Chuy·ªÉn kho·∫£n MB Bank';
                 // ·∫¢nh MB Bank t·ª´ link b·∫°n cung c·∫•p
                qrImage.src = 'https://i.supaimg.com/672ac9e6-1172-450c-b4ad-fd90503e04dc.jpg';
            } else {
                return;
            }
            
            qrModal.classList.remove('hidden');
            qrModal.classList.add('flex');
            document.body.style.overflow = 'hidden'; // NgƒÉn cu·ªôn n·ªÅn
        }
        
        // ƒê√≥ng modal QR/Bank (H√ÄM M·ªöI)
        function closeQRCodeModal(event) {
             if (!event || event.target.id === 'qr-payment-modal' || event.currentTarget.tagName === 'BUTTON') {
                document.getElementById('qr-payment-modal').classList.add('hidden');
                document.getElementById('qr-payment-modal').classList.remove('flex');
                document.body.style.overflow = ''; // Cho ph√©p cu·ªôn l·∫°i
            }
        }
        
        // H√ÄM M·ªöI: Quay l·∫°i m√†n h√¨nh ch·ªçn thanh to√°n t·ª´ m√†n h√¨nh QR
        function returnToPaymentOptions() {
            closeQRCodeModal(); // ƒê√≥ng QR modal
            
            // M·ªü l·∫°i Plan Detail Modal
            document.getElementById('plan-detail-modal').classList.remove('hidden');
            document.getElementById('plan-detail-modal').classList.add('flex');
            document.body.style.overflow = 'hidden'; 
            
            // ƒê·∫£m b·∫£o hi·ªÉn th·ªã ngay m√†n h√¨nh ch·ªçn ph∆∞∆°ng th·ª©c thanh to√°n
            showPaymentOptions(); 
        }
        
        // --- H√ÄM RENDER KHU V·ª∞C HOME V√Ä SEARCH ---
        
        function renderSearchResults(query = '', genre = 'all') {
            setViewMode('search'); 

            const resultsContainer = document.getElementById('search-results-container');
            const noResults = document.getElementById('no-results');
            resultsContainer.innerHTML = '';
            
            const searchableMovies = getRegularMovies();
            const normalizedQuery = query.toLowerCase().trim();
            let filteredByQuery;
            if (normalizedQuery.length > 0) {
                filteredByQuery = searchableMovies.filter(movie => 
                    movie.title.toLowerCase().includes(normalizedQuery)
                );
            } else {
                filteredByQuery = searchableMovies;
            }
            
            let finalFilteredMovies;
            if (genre !== 'all') {
                finalFilteredMovies = filteredByQuery.filter(movie => movie.genre === genre);
            } else {
                finalFilteredMovies = filteredByQuery;
            }
            
            // Hi·ªÉn th·ªã k·∫øt qu·∫£
            if (finalFilteredMovies.length > 0) {
                noResults.classList.add('hidden');
                finalFilteredMovies.forEach(movie => {
                    resultsContainer.appendChild(createPosterCard(movie, true)); 
                });
            } else {
                noResults.classList.remove('hidden');
            }
        }

                function renderSections() {
    const recommendedContainer = document.getElementById('recommended-movies');
    const continueContainer = document.getElementById('continue-watching');
    const mostViewedContainer = document.getElementById('most-viewed-movies');
    const animationContainer = document.getElementById('animation-sections');
    // L·∫•y th√™m container c·ªßa Anime
    const animeContainer = document.getElementById('anime-sections');

    // Reset n·ªôi dung c≈©
    recommendedContainer.innerHTML = '';
    continueContainer.innerHTML = '';
    mostViewedContainer.innerHTML = '';
    if (animationContainer) animationContainer.innerHTML = '';
    if (animeContainer) animeContainer.innerHTML = '';

    renderBanners();

    // Render ƒê·ªÅ xu·∫•t v√† Xem nhi·ªÅu
    getRegularMovies().slice(0, 100).forEach(movie => {
        recommendedContainer.appendChild(createPosterCard(movie));
    });
    getContinueMovies().forEach(movie => {
        continueContainer.appendChild(createContinueCard(movie));
    });
    getRegularMovies().slice(0, 4).forEach(movie => {
        mostViewedContainer.appendChild(createPosterCard(movie));
    });

    // Render Ho·∫°t h√¨nh (genre: "animation")
    if (animationContainer) {
        getRegularMovies()
            .filter(movie => movie.genre === 'animation')
            .forEach(movie => animationContainer.appendChild(createPosterCard(movie)));
    }

    // Render Anime (genre: "anime") - ƒêO·∫†N B·ªî SUNG
    if (animeContainer) {
        getRegularMovies()
            .filter(movie => movie.genre === 'anime')
            .forEach(movie => animeContainer.appendChild(createPosterCard(movie)));
    }
}

        
        function searchMovies(query) {
            if (query.length === 0 && document.getElementById('search-bar').classList.contains('hidden')) {
                return;
            } else if (query.length === 0) {
                 setViewMode('home');
                 return;
            }
            
            setViewMode('search'); // Chuy·ªÉn sang ch·∫ø ƒë·ªô t√¨m ki·∫øm
            renderSearchResults(query, 'all'); 
            
            // ƒê·∫£m b·∫£o n√∫t filter v·ªÅ tr·∫°ng th√°i 'T·∫•t c·∫£' khi nh·∫≠p t√¨m ki·∫øm m·ªõi
            document.querySelectorAll('.genre-button').forEach(btn => {
                btn.classList.remove('bg-red-600', 'hover:bg-red-600/70');
                btn.classList.add('bg-gray-700', 'hover:bg-red-600');
                if (btn.getAttribute('data-genre') === 'all') {
                     btn.classList.remove('bg-gray-700', 'hover:bg-red-600');
                     btn.classList.add('bg-red-600', 'hover:bg-red-600/70');
                }
            });
        }


        // Script ch·∫°y khi t·∫£i trang xong
        document.addEventListener('DOMContentLoaded', () => {
             renderSections(); // Kh·ªüi t·∫°o c√°c ph·∫ßn Home v√† Banner
             setupNotificationListeners(); // Thi·∫øt l·∫≠p s·ª± ki·ªán cho n√∫t th√¥ng b√°o
             setViewMode('home'); // ƒê·∫£m b·∫£o b·∫Øt ƒë·∫ßu ·ªü ch·∫ø ƒë·ªô Home (banner hi·ªÉn th·ªã)
             
            // Bi·∫øn v√† Elements
            const searchButton = document.getElementById('search-button');
            const searchBar = document.getElementById('search-bar');
            const searchInput = document.getElementById('search-input');
            const genreButtons = document.querySelectorAll('.genre-button');
            const planButton = document.getElementById('plan-button'); // L·∫•y n√∫t Mua

            // X·ª≠ l√Ω n√∫t Mua (B·∫Øt ƒë·∫ßu qu√° tr√¨nh thanh to√°n)
            planButton.addEventListener('click', () => {
                showPlanDetailModal();
            });
            
            // X·ª≠ l√Ω n√∫t MUA G√ìI ban ƒë·∫ßu ƒë·ªÉ hi·ªÉn th·ªã l·ª±a ch·ªçn thanh to√°n (H√ÄM M·ªöI)
            document.getElementById('initial-buy-button').addEventListener('click', () => {
                 showPaymentOptions();
            });

            // X·ª≠ l√Ω n√∫t t√¨m ki·∫øm (Bi·ªÉu t∆∞·ª£ng k√≠nh l√∫p/X)
            searchButton.addEventListener('click', () => {
                const isSearching = searchBar.classList.contains('hidden');
                
                if (isSearching) {
                    // D·ª´ng auto slide khi v√†o Search
                    clearInterval(slideInterval);
                    
                    // Chuy·ªÉn sang ch·∫ø ƒë·ªô t√¨m ki·∫øm
                    searchBar.classList.remove('hidden');
                    searchInput.focus();
                    
                    // Hi·ªÉn th·ªã view Search
                    setViewMode('search'); 
                    renderSearchResults('', 'all'); 
                    
                    // Thay ƒë·ªïi icon search th√†nh X
                    searchButton.innerHTML = `<svg class="icon-base" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>`;
                    

                } else {
                    // Tho√°t kh·ªèi ch·∫ø ƒë·ªô t√¨m ki·∫øm
                    searchBar.classList.add('hidden');
                    searchInput.value = ''; // X√≥a n·ªôi dung t√¨m ki·∫øm
                    
                    // ƒê·∫∑t l·∫°i icon v·ªÅ search
                    searchButton.innerHTML = `<svg class="icon-base" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>`;
                    
                    // Hi·ªÉn th·ªã l·∫°i Home view (banner hi·ªÉn th·ªã)
                    setViewMode('home');
                }
            });

            // L·∫Øng nghe s·ª± ki·ªán g√µ ph√≠m trong tr∆∞·ªùng t√¨m ki·∫øm
            searchInput.addEventListener('input', (event) => {
                searchMovies(event.target.value);
            });
            
            // X·ª≠ l√Ω n√∫t ph√¢n lo·∫°i
            genreButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const selectedGenre = this.getAttribute('data-genre');
                    const currentQuery = searchInput.value;
                    
                    // 1. C·∫≠p nh·∫≠t tr·∫°ng th√°i active cho n√∫t
                    genreButtons.forEach(btn => {
                        btn.classList.remove('bg-red-600', 'hover:bg-red-600/70');
                        btn.classList.add('bg-gray-700', 'hover:bg-red-600');
                    });
                    this.classList.remove('bg-gray-700', 'hover:bg-red-600');
                    this.classList.add('bg-red-600', 'hover:bg-red-600/70');
                    
                    // 2. Th·ª±c hi·ªán l·ªçc d·ª±a tr√™n query hi·ªán t·∫°i v√† th·ªÉ lo·∫°i m·ªõi
                    renderSearchResults(currentQuery, selectedGenre);
                });
            });


            // X·ª≠ l√Ω Tab Link (Logic c≈©)
            const tabLinks = document.querySelectorAll('.tab-link');
            tabLinks.forEach(link => {
                link.addEventListener('click', function(event) {
                    event.preventDefault(); 
                    
                    tabLinks.forEach(l => {
                        l.classList.remove('active', 'text-red-600');
                        l.classList.add('text-gray-400');
                        l.querySelector('.icon-base')?.classList.remove('active');
                    });

                    this.classList.add('active', 'text-red-600');
                    this.classList.remove('text-gray-400');
                    this.querySelector('.icon-base')?.classList.add('active');
                    
                    // Khi nh·∫•p v√†o tab, ƒë·∫£m b·∫£o ƒëang ·ªü Home view
                    if (this.getAttribute('href') === '#') {
                        // N·∫øu ƒëang ·ªü Search ho·∫∑c Notification view, chuy·ªÉn v·ªÅ Home (banner hi·ªÉn th·ªã)
                        setViewMode('home');
                        searchBar.classList.add('hidden');
                        searchButton.innerHTML = `<svg class="icon-base" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg>`;
                    }
                });
            });
        });
    </script>
</body>
</html>
